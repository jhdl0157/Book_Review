# 3장

## 3장에서는 2장에서 구현한 기능에서 추가 기능을 넣을려고 한다. 어떤 방식으로 추가 기능을 구현할지에 대한 방법을 제시해준다.

### 개방/폐쇄 원칙
2장에서 구현한 기능중에서 특정 금액 이상의 거래 내역 찾기 코드가 있다.
```java
    public List<BankTransaction> findTransactionsGreaterThanEqual(final int amount){
        final List<BacnkTransaction> result=new ArrayList<>();
        for(final BankTransaction bankTransaction : bankTransactions){
            if(bankTransaction.getAmount() >= amount){
                result.add(bankTransaction);
            }
        }
        return result;
    } 
```
이제 새로운 기능인 특정월 입출금을 찾는 메서드를 구현해보자

```java
public List<BankTransaction> findTransactionsInMonth(final Month month){
        final List<BacnkTransaction> result=new ArrayList<>();
        for(final BankTransaction bankTransaction : bankTransactions){
            if(bankTransaction.getMonth() == month){
                result.add(bankTransaction);
            }
        }
        return result;
    }
```
아마 이런식으로 중복 코드가 생성이 될것이다. 
이러한 방법에서 개방/폐쇄 원칙을 적용해본다.
현재 코드에는 비즈니스 로직이 결합이 되어 있다. 따라서 비즈니스 로직을 인터페이스를 만들어서 해결을 해보자

```java
@FunctionalInterface
    public interface BankTransactionFilter{
        boolean test(BankTransaction bankTransaction);
    }
```

```java
public List<BankTransaction> findTransactions(final BankTransactionFilter bankTransactionFilter){
        final List<BacnkTransaction> result=new ArrayList<>();
        for(final BankTransaction bankTransaction : bankTransactions){
            if(bankTransactionFilter.test(bankTransaction)){
                result.add(bankTransaction);
            }
        }
        return result;
    }
```

좀더 쉽게 하기 위해서 람다식을 사용한다.
```java
  final List<BankTransaction> transactions=bankStatementProcessor.findTransactions(bankTransaction -> 
            bankTransaction.getDate().getMonth()== Month.FEBRUARY 
                    && bankTransaction.getAmount() >= 10000);
```

계방 폐쇄 원칙을 사용하면 다음과 같은 장점을 가질수 있다. 
- 기존 코드를 바꾸지 않으므로 기존 코드가 잘못될 가능성이 줄어든다.
- 코드가 중복되지 않으므로 기존 코드의 재사용성이 높아진다.
- 결합도가 낮아지므로 코드 유지보수성이 좋아진다.
